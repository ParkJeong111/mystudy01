<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="morepage">

	<!-- 김채은 영역 시작 -->

	<!-- 김채은 영역 끝 -->


	<!-- 권세진 영역 시작 -->

	<!-- 권세진 영역 끝 -->


	<!-- 박정연 영역 시작 -->

	<!-- 박정연 영역 끝 -->


	<!-- 주성중 영역 시작 -->

	<select id="hostlist" parameterType="int" resultType="hldto">
		select h.himage as himage,h.hname as hname
		, h.hstar as hstar, hg.hgmoney as hgmoney, h.hnotice as hnotice
		, h.haddr as haddr, h.hnum as hnum
		from host h, hostgoods hg
		where h.hname = hg.hname and
		<choose>
			<when test="type == 1">
				htype = '바다'
			</when>
			<when test="type == 2">
				htype = '민물'
			</when>
			<when test="type == 3">
				htype = '전문'
			</when>
			<when test="type == 4">
				htype = '카페'
			</when>
			<otherwise></otherwise>
		</choose>
	</select>
	
	<select id="matchlist" resultType="mbdto">
		select mbnum, mbtitle, mid, mbcontent, mbtag, mbperson, mblocation, mbimage,
		to_char(mbstartdate,'YYYY-MM-DD') as mbstartdate, mbdate, mbreport
		from matchingboard
	</select>
	<!-- 주성중 영역 끝 -->

	<!-- 송용화 영역 시작 -->
	
	<!-- Host Detail 시작 -->
	<resultMap type="hdto" id="hdto">
		<result column="himage" property="himage"/>
		<result column="hname" property="hname"/>
		<result column="hstar" property="hstar"/>
		<result column="hnotice" property="hnotice"/>
		<result column="htype" property="htype"/>
		<result column="haddr" property="haddr"/>
		<result column="hnum" property="hnum"/>
		<result column="howner" property="howner"/>
		<result column="hspecies" property="hspecies"/>
		<result column="hservice" property="hservice"/>
		<collection property="hgdto" resultMap="hgdto"></collection>
	</resultMap>
	
	<resultMap type="hgdto" id="hgdto">
		<result column="hgname" property="hgname"/>
		<result column="hginfo" property="hginfo"/>
		<result column="hgmoney" property="hgmoney"/>
		<result column="hgnum" property="hgnum"/>
	</resultMap>
	
	<select id="hostdetail" parameterType="int" resultMap="hdto">
		select h.himage as himage, h.hname as hname,
		h.hstar as hstar, h.hnotice as hnotice, h.htype as htype, h.hservice as hservice,
		h.haddr as haddr, h.hnum as hnum, h.howner as howner, h.hspecies as hspecies,
        hg.hgname as hgname, hg.hginfo as hginfo, hg.hgmoney as hgmoney, hg.hgnum as hgnum
		from host h, hostgoods hg
		where h.hname = hg.hname and h.hnum = #{hnum}
	</select>
	<!-- Host Detail 끝 -->
	
	<!-- Host Reserve 시작 -->
	<select id="hostgoodsdetail" parameterType="int" resultType="hgdto">
		select hgnum, hname, hgname, hginfo, hgmoney from hostgoods
		where hgnum = #{hgnum}
	</select>
	<!-- Host Reserve 끝 -->
	
	<!-- Host Search 시작 -->
	<select id="searchlist" parameterType="hsdto" resultType="hldto">
		select h.himage as himage,h.hname as hname
		, h.hstar as hstar, hg.hgmoney as hgmoney, h.hnotice as hnotice
		, h.haddr as haddr, h.hnum as hnum
		from host h, (select hgname, hgmoney, hname from hostgoods where rownum <![CDATA[ < ]]> 2) hg
        where hgmoney between #{minprice} and #{maxprice} 
        <if test="searchValue != null">
         	and h.hname like '%' || #{searchValue} || '%'
        </if>
	</select>	
	<!-- Host Seach 끝 -->
	<!-- 송용화 영역 끝 -->
</mapper>